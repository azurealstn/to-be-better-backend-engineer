# [Book] 모두의 깃 & 깃허브

지금부터 정리할 내용은 책 [모두의 깃 & 깃허브](https://www.yes24.com/Product/Goods/110795446)와 인프런 강의인 [모두의 깃 & 깃허브](https://www.inflearn.com/course/%EB%AA%A8%EB%91%90%EC%9D%98-%EA%B9%83-%EA%B9%83%ED%97%88%EB%B8%8C)를 참고하였습니다. 제대로 공부하시려면 위 2가지를 모두 직접 학습하시는 것을 추천드립니다.

## 목차

- [버전](#버전)
- [깃이란](#깃이란)
- [세 개의 공간](#세-개의-공간)
- [태그와 릴리스](#태그와-릴리스)
- [작업 되돌리기](#작업-되돌리기)
- [스태시로 작업 임시 저장하기](#스태시로-작업-임시-저장하기)

## 버전

새로운 버전은 주로 기능이 새로 추가되거나 크고 작은 버그가 수정되는 등 기존과는 다른 유의미한 변화가 생겼을 때 만들어진다. 즉, 버전이란 **유의미한 변화가 결과물론 나온 것, 유의미한 변화가 결과물로 저장된 것**을 의미한다.

버전 관리란, 이러한 유의미한 변화를 쌓아 올리면서 소프트웨어를 만들어가는 과정이다.

## 깃이란

깃은 버전 관리를 도와주는 소프트웨어로, 버전 관리 시스템(Version Control System, VCS)이다.

## 세 개의 공간

버전이 만들어지는 과정을 이해하려면 깃이 관리하는 세 개의 공간, 작업 디렉터리(working directory), 스페이지(stage), 저장소(repository)를 먼저 이해해야 한다.

### 작업 디렉터리

깃을 이용해 작업 디렉터리 내에 위치한 파일 및 폴더의 현재 상태를 버전으로 만들고, 만들어진 버전을 관리할 수 있다. 즉, 작업 디렉터리는 버전 관리의 대상이 위치하는 공간을 말한다.

여기서 버전을 만든다는 의미는 특정 순간의 변경 사항을 기억한다와 같다. 따라서 작업 디렉터리에 있는 프로젝트에 변경 사항이 생기는 순간 새로운 버전을 만들 수 있게 된다.

이 때 모든 변경 사항을 새로운 버전으로 만들 필요가 없는데, 모든 변경 사항 중에서도 새로운 버전으로 만들 필요가 있는 것과 없는 것을 구분하기 위해 **스테이지**가 있다.

### 스테이지

깃으로 버전을 만들 때는 작업 디렉터리 내에서 변경된 파일들 중에서 새로운 버전이 될 파일만 특별한 공간으로 옮기는 작업을 거치게 된다. 이 특별한 공간이 바로 **스테이지**이다. 즉, 스테이지는 변경 사항이 있는 파일 중 다음 버전이 될 후보가 올라가는 공간인 셈이다.

다시 말해, 버전을 만들기 위해 작업 디렉터리에 있는 파일에 변경 사항을 만들고, 이 변경 사항들 중 새로운 버전으로 만들려는 파일을 선별해 스테이지로 옮긴다.

작업 디렉터리에서 버전이 될 후보 파일을 스테이지로 옮기는 것을 스테이지에 추가한다(add) 또는 해당 파일을 스테이지시킨다(staged) 라고 표현한다.

> 스테이지는 스테이징 영역(staging area) 또는 인덱스(index)라고도 부른다.

### 저장소

스테이지에 있는 파일을 바탕으로 새로운 버전을 만들면 새 버전이 저장소에 추가된다. 즉, 저장소는 버전이 만들어지고 관리되는 공간이다.

저장소에 새로운 버전을 만드는 것을 커밋한다(commit) 라고 표현한다. 각 커밋에는 고유한 커밋 해시가 있다. 커밋 해시란 마치 학번, 사번과 같이 각 커밋이 가진 고유한 ID이다.

> 커밋 메시지  
> 커밋 메시지란, 버전을 설명하는 메시지다.
> 내가 지금 어떤 파일을 어떻게 변경했는지, 왜 이렇게 변경했는지 등의 내용을 담은 일종의 쪽지라고 볼 수 있다.
> 커밋 메시지는 자칫 별것 아닌 것처럼 보일지라도 여러명의 개발자들끼리 협업하기 위해서는 매우 중요한 의사소통 수단이 된다.

### .gitignore

종종 버전 관리 대상에서 제외하고 싶은 파일이나 폴더, 즉 변경 사항이 생기더라도 앞으로도 쭉 버전에 포함하고 싶지 않은 파일이나 폴더 있을 수 있다. **.gitignore** 파일은 쉽게 말해 무시할 파일/폴더 목록을 적은 파일을 말한다.

## 태그와 릴리스

모든 의미 있는 소프트웨어는 사용자가 있다. 웹서비스든 앱이든 깃처럼 개발을 돕기 위한 도구든, 모든 소프트웨어는 사용하기 위해 만들어진 존재이다.

로그인 기능, 글쓰기 기능, 버그 수정 등 커밋이 쌓이며 웹 서비스 또는 앱이 점차 완성되어 간다. 그러다 이제 충분히 개발됐다고 판단하면 사용자에게 결과물을 선보일 것이다.

개발한 소프트웨어를 사용자에게 선보이는 것을 **릴리스(release)**라고 한다. 즉, 커밋이 쌓이면 언젠간 사용자에게 릴리스하게 된다.

이 때 사용자에게 선보이는 버전은 어떻게 표기하는 것이 좋을까?
커밋에 고유한 해시 값이 있으나 이는 가독성이 좋지 않다.

이럴 때 사용하는 것이 바로 태그(tag)다.

각 커밋에는 커밋 해시라는 고유한 문자열이 있고, 이렇게 쌓이고 쌓인 커밋에 태그라는 꼬리표를 붙일 수 있다. 그리고 이 꼬리표 안에는 보통 버전을 작성하는 규칙에 따라 작성된 버전을 명시하고, 사용자에게 내놓을 준비가 끝나면 이를 릴리스하게 된다.

## 작업 되돌리기

하나의 버전은 다음과 같은 과정을 통해 만들어진다.

1. 작업 디렉터리에서 변경 사항 생성하기
2. 스테이지로 올리기
3. 커밋하기

- 아직 스테이지로 올리지 않은 변경된 파일을 취소하려면 어떻게 해야할까?
- 스테이지에 올라간 파일은 어떻게 취소할까?
- 이미 커밋한 파일은 어떻게 취소할 수 있을까?

### 스테이지에 올라간 파일 되돌리기

...

### 커밋 되돌리기

이미 커밋한 내용을 되돌리는 방법은 크게 두 가지가 있다.

- revert
- reset

#### revert

revert는 버전을 되돌리되, 되돌아간 상태에 대한 새로운 버전(커밋)을 만드는 방식이다. 중요한 점은 **기존의 버전은 삭제되지 않는다**는 점이다.

#### reset

reset은 되돌아갈 버전의 시점으로 완전하게 되돌아가는 방식이다. 즉, **되돌아갈 버전 이후의 버전은 삭제되는 방식**이다.

reset에는 크게 세 종류 soft, mixed, hard가 있다.

- soft: 작업 디렉터리 내 변경 사항과 스테이지에 추가된 변경 사항은 유지하되, 커밋했다는 사실만 되돌리는 reset을 soft reset 이라고 한다.
- mixed: 작업 디렉터리 내 변경 사항은 유지하되, 스테이와 커밋을 되돌리는 reset을 mixed reset 이라고 한다.
- hard: 작업 디렉터리 내 변경 사항까지 통째로 되돌리는 reset을 hard reset 이라고 한다.

## 스태시로 작업 임시 저장하기

깃은 스태시(stash)라는 임시 저장 기능을 지원한다.  
파일 수정하면서 아래와 같은 상황이 발생할 수 있다.

1. 작업 내역이 썩 마음에 들지 않지만 버리기는 아까울 때
2. 갑자기 다른 더 중요한 일을 처리해야 할 때

위와 같이 지금까지의 변경 내역을 전부 지워버리는 것보다 어딘가에 임시 저장해두면 좋다.  
스태시를 사용하게 되면 작업 디렉터리에서 생성한 모든 변경 사항이 임시 저장되고, 작업 디렉터리는 변경 사항이 생기기 전의 깨끗한 상태로 돌아간다.

또한 스태시로 임시 저장된 변경 사항들은 언제든 다시 꺼내어 작업 디렉터리에 다시 적용할 수 있다.

> 참고  
> 스태시는 깃이 변경 사항을 추적하는(tracked) 파일에만 사용할 수 있다. 즉, 스테이지에 이미 올라와 있거나 한번이라도 커밋한 적이 있는 파일에만 사용이 가능하다.  
> 방금 막 생성한 파일처럼 깃이 기존에 변경 사항을 추적하지 않은(untracked) 파일에는 스태시를 사용할 수 없다.
